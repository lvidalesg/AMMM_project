# AMMM Project - GRASP Solver

This part of the project handles solving instances of the camera coverage problem using a **GRASP (Greedy Randomized Adaptive Search Procedure)** metaheuristic in Python.

---

## Overview

1. **Input Instances**: originally generated by the Instance Generator in **optimization format** (`.dat` files).  
2. **Transformation**: `load_data_python.py` converts these `.dat` files into Python readable datafiles.  
3. **GRASP Algorithm**: iteratively builds and improves solutions to minimize total weekly camera cost while covering all crossings.
4. **Solution Output**: solutions are saved as `.grasp.sol` files in the GRASP folder.

---

## How to Run

### Single Instance
```python
from grasp import main

# Run GRASP with default parameters (100 iterations, alpha=0.3)
main("datafile.dat")

# Run with custom parameters
main("datafile.dat", max_iterations=200, alpha=0.5, use_grasp=True)

# Run pure greedy (no GRASP)
main("datafile.dat", use_grasp=False)
```

### Command Line
```bash
# Single file with defaults
python grasp.py path/to/datafile.dat

# Custom parameters: iterations, alpha, use_grasp
python grasp.py path/to/datafile.dat 200 0.5 true

# Batch mode (processes multiple files)
python grasp.py
```

---

## How the GRASP Algorithm Works

### 1. **Candidate Generation**
Computes all possible camera placements using `compute_coverages()`. Each candidate has:
- A crossing location
- A camera model/type
- A weekly on/off pattern (valid runs of 2-7 consecutive active days)
- A cost (installation + daily operation costs)
- Coverage set (which nodes and days are covered)

### 2. **GRASP Iterations**
For each iteration:

#### **Construction Phase** (Greedy Randomized)
- Builds a solution semi-greedily using a Restricted Candidate List (RCL)
- At each step:
  1. Calculate cost-per-coverage ratio for each valid candidate
  2. Build RCL with candidates having score ≤ min_score + α×(max_score - min_score)
  3. Randomly select a candidate from RCL (adds randomization)
  4. Add to solution and mark location as used
- Parameter **alpha** controls randomization:
  - α = 0: pure greedy (always best candidate)
  - α = 1: pure random (from all valid candidates)
  - α ∈ (0,1): semi-greedy (typical: 0.2-0.4)

#### **Local Search Phase**
Improves the constructed solution by:
- Trying to remove cameras that are redundant
- Swapping cameras for cheaper alternatives
- Continues until no improvement is found

### 3. **Best Solution Tracking**
- Keeps track of the best solution found across all iterations
- Returns the solution with minimum total weekly cost

---

## Parameters

- **max_iterations** (default: 100): Number of GRASP iterations to run
- **alpha** (default: 0.3): RCL randomization parameter
  - Lower values → more greedy (faster, but may miss good solutions)
  - Higher values → more random exploration (slower, better solution quality)
- **use_grasp** (default: True): If False, runs pure greedy algorithm

---

## Output Format

Solution files (`.grasp.sol`) contain:
```
GRASP Solution
Parameters: max_iterations=100, alpha=0.3
==================================================

Camera #1:
  Crossing: 5
  Model:    2
  Pattern:  1111000
  Days ON:  ['Mon', 'Tue', 'Wed', 'Thu']
  Weekly cost: 450 euros

...

TOTAL WEEKLY COST = 2340 euros
Elapsed time: 12.45 seconds
```

---

## Comparison with Pure Greedy

- **Greedy**: Fast, deterministic, but may get stuck in local optima
- **GRASP**: Slower, but explores solution space better through randomization
- Expected improvement: GRASP typically finds 5-20% better solutions than pure greedy

